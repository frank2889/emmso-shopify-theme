class PredictiveSearch extends HTMLElement{constructor(){super(),this.input=this.querySelector('input[type="search"]'),this.resultsContainer=this.querySelector("[data-predictive-search-results]"),this.searchForm=this.querySelector("form"),this.input&&this.setupEventListeners()}setupEventListeners(){let e;this.input.addEventListener("input",t=>{clearTimeout(e);const s=t.target.value.trim();s.length<2?this.close():e=setTimeout(()=>{this.getSearchResults(s)},300)}),this.input.addEventListener("keydown",e=>{"Escape"===e.key&&this.close()}),document.addEventListener("click",e=>{this.contains(e.target)||this.close()})}getSearchResults(e){const t=`${window.Shopify.routes.root}search/suggest.json?q=${encodeURIComponent(e)}&resources[type]=product&resources[limit]=6`;fetch(t).then(e=>e.json()).then(e=>{this.renderResults(e.resources.results)}).catch(e=>{console.error("Predictive search error:",e)})}renderResults(e){if(!e||!e.products||0===e.products.length)return void this.close();const t=e.products;let s='<div class="predictive-search__results">';t.forEach(e=>{const t=e.featured_image?e.featured_image:"",i=this.formatMoney(e.price);s+=`\n        <a href="${e.url}" class="predictive-search__item">\n          ${t?`<img src="${t}" alt="${e.title}" class="predictive-search__image" loading="lazy">`:""}\n          <div class="predictive-search__content">\n            <div class="predictive-search__title">${e.title}</div>\n            ${e.vendor?`<div class="predictive-search__vendor">${e.vendor}</div>`:""}\n            <div class="predictive-search__price">${i}</div>\n          </div>\n        </a>\n      `}),s+=`\n      <div class="predictive-search__footer">\n        <a href="${window.Shopify.routes.root}search?q=${encodeURIComponent(this.input.value)}" class="predictive-search__view-all">\n          Bekijk alle resultaten\n        </a>\n      </div>\n    `,s+="</div>",this.resultsContainer&&(this.resultsContainer.innerHTML=s,this.open())}formatMoney(e){return"â‚¬"+(e/100).toFixed(2).replace(".",",")}open(){this.resultsContainer&&(this.resultsContainer.classList.add("is-visible"),this.resultsContainer.removeAttribute("hidden"))}close(){this.resultsContainer&&(this.resultsContainer.classList.remove("is-visible"),this.resultsContainer.setAttribute("hidden",""))}}customElements.define("predictive-search",PredictiveSearch);